# AudioPlayer 简洁架构设计

本项目采用简洁的MVVM架构，专注于代码的可读性和易维护性。

## 设计原则

1. **简洁性** - 每个类都有明确的单一职责，避免过度设计
2. **可读性** - 使用清晰的命名和简洁的代码结构
3. **易维护** - 模块化设计，便于修改和扩展

## 架构层次

### UI层 (MainActivity)
- **职责**: 处理用户交互和界面更新
- **特点**: 
  - 使用Material Design组件
  - 简洁的布局设计
  - 清晰的状态反馈

### ViewModel层 (PlayerViewModel)
- **职责**: 管理UI状态，连接UI和业务逻辑
- **特点**:
  - 使用LiveData进行数据绑定
  - 简化的状态管理
  - 自动处理生命周期

### 业务逻辑层 (AudioPlayer)
- **职责**: 音频播放核心功能
- **特点**:
  - 简化的播放流程
  - 清晰的错误处理
  - 自动资源管理

### 数据层 (WaveFile)
- **职责**: WAV文件读取和解析
- **特点**:
  - 简洁的文件操作
  - 基本的格式验证
  - 安全的资源释放

## 主要改进

### 1. UI设计
- 采用现代Material Design风格
- 使用卡片式布局展示状态
- 清晰的按钮状态反馈

### 2. 代码简化
- 减少不必要的复杂性
- 统一的错误处理方式
- 简化的日志输出

### 3. 用户体验
- 中文界面提示
- 清晰的状态信息
- 友好的错误提示

## 使用方法

```bash
# 准备测试文件
adb root && adb remount && adb shell setenforce 0
adb push 48k_2ch_16bit.wav /data/

# 安装应用
adb install app-debug.apk
```

## 文件结构

```
com.example.audioplayer/
├── MainActivity.kt              // 主界面
├── model/
│   └── WaveFile.kt              // WAV文件处理
├── player/
│   └── AudioPlayer.kt           // 音频播放器
└── viewmodel/
    └── PlayerViewModel.kt       // 视图模型
```

## 核心特性

- **简洁的代码结构** - 易于理解和维护
- **现代化UI设计** - 符合Material Design规范
- **多通道音频支持** - 支持1-8声道音频播放
- **多种音频格式** - 支持8/16/24/32位音频
- **完整的错误处理** - 友好的用户提示
- **自动资源管理** - 防止内存泄漏
- **中文本地化** - 更好的用户体验

## 音频格式支持

### 支持的声道配置
- **1声道**: 单声道 (Mono)
- **2声道**: 立体声 (Stereo)
- **3声道**: 2.1声道 (Stereo + Center)
- **4声道**: 四声道 (Quad)
- **5声道**: 4.1声道 (Quad + Center)
- **6声道**: 5.1声道 (5.1 Surround)
- **7声道**: 6.1声道 (6.1 Surround)
- **8声道**: 7.1声道 (7.1 Surround)
- **10声道**: 5.1.4声道 (5.1 + 4天空声道)
- **11声道**: 6.1.4声道 (6.1 + 4天空声道)
- **12声道**: 7.1.4声道 (7.1 + 4天空声道) ⭐

### 7.1.4声道布局详解
7.1.4是一种3D音频格式，包含12个声道：
- **前置层 (4声道)**: L, R, C, LFE
- **环绕层 (4声道)**: Ls, Rs, Lrs, Rrs  
- **天空层 (4声道)**: Ltf, Rtf, Ltb, Rtb

### 支持的音频参数
- **采样率**: 8kHz - 192kHz
- **位深度**: 8bit, 16bit, 24bit, 32bit
- **格式**: WAV (PCM)
- **最大声道**: 12声道 (7.1.4)

### 自动参数验证
- 检查音频参数有效性
- 验证设备兼容性
- 7.1.4格式特殊检测
- 提供详细的错误信息

### 性能优化
- 根据声道数动态调整缓冲区大小
- 12声道使用8KB缓冲区优化性能
- 实时播放进度监控
- 内存使用优化